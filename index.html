<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ConexiÃ³n Viva ğŸ’–</title>
<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>

<body style="text-align:center; font-family:Arial; background:#fff0f5;">

<h2>ğŸ’Œ ConexiÃ³n Viva</h2>

<p><b>Mensaje de Kevin:</b></p>
<p id="mensaje">Esperando...</p>
<p id="color"></p>

<hr>

<button onclick="send('latido')">ğŸ’“ Latido</button><br><br>
<button onclick="send('servo')">ğŸ¤— Abrazo (servo)</button><br><br>
<button onclick="send('arcoiris')">ğŸŒˆ ArcoÃ­ris</button><br><br>
<button onclick="send('buzzer')">ğŸ”” PiÃ©nsame</button>

<script>
const client = mqtt.connect("wss://test.mosquitto.org:8081");

client.on("connect", () => {
  client.subscribe("conexion/esp32/kevin");
});

client.on("message", (topic, message) => {
  const data = JSON.parse(message);
  document.getElementById("mensaje").innerText = data.mensaje;
  document.getElementById("color").innerText = "Color: " + data.color;
});

function send(accion) {
  client.publish(
    "conexion/web/ella",
    JSON.stringify({ accion: accion })
  );
}
</script>

</body>
</html>
